<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How to profile C++ application with Callgrind / KCacheGrind | Blog blog("Baptiste Wicht");</title>
<script src="/cdn-cgi/apps/head/98vpnawSZZMscPn4oDND-ZgswjM.js"></script><link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">
<link rel="canonical" href="http://baptiste-wicht.com/posts/2011/09/profile-c-application-with-callgrind-kcachegrind.html">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Baptiste Wicht">
<link rel="prev" href="../08/compute-metrics-of-c-project-using-cccc.html" title="How to compute metrics of C++ project using CCCC" type="text/html">
<link rel="next" href="book-review-effective-c.html" title="Book Review : Effective C++" type="text/html">
<meta property="og:site_name" content='Blog blog("Baptiste Wicht");'>
<meta property="og:title" content="How to profile C++ application with Callgrind / KCacheGrind">
<meta property="og:url" content="http://baptiste-wicht.com/posts/2011/09/profile-c-application-with-callgrind-kcachegrind.html">
<meta property="og:description" content="I have shown before how to profile a C++ application using the Linux perf tools.  In this post, we will see how to profile the same kind of application using Callgrind. Callgrind is a tool in part of ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2011-09-01T08:25:10+02:00">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Performances">
<meta property="article:tag" content="Tools">
<link href="../../../favicon.ico" rel="icon" type="image/x-icon">
<link rel="publisher" href="https://plus.google.com/+BaptisteWicht">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-2175227-7', 'auto');
  var metas = document.getElementsByTagName('meta'), tagsList = [];
  for (var i=0; i<metas.length; i++) {
    if (metas[i].getAttribute('property') == 'article:tag') {
      tagsList.push( metas[i].getAttribute('content'));
    }
  }
  ga('set', 'dimension1', tagsList.join('|'));
  ga('send', 'pageview');
</script>
</head>
<body>

<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
<div class="container-fluid">

<div class="row">
<div class="col-sm-3 col-lg-2">
<nav class="navbar navbar-inverse navbar-fixed-side"><div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="http://baptiste-wicht.com/">
<span id="blog-title">Blog blog("Baptiste Wicht");</span>
</a>
</div>

<div class="collapse navbar-collapse navbar-ex1-collapse">
<ul class="nav navbar-nav">
<li>
<a href="../../../stories/about.html">About</a>
</li>
<li>
<a href="../../../stories/publications.html">Publications</a>
</li>
<li>
<a href="../../../stories/projects.html">Projects</a>
</li>
<li>
<a href="../../../categories/index.html">Tags</a>
</li>
<li>
<a href="../../../archive.html">Archives</a>
</li>
<li>
<a href="http://feeds.feedburner.com/BaptisteWicht">RSS</a>
</li>
<li class="navbar-content">
<h3>Related posts</h3>
</li>
<li><a href="../07/profile-applications-linux-perf-tools.html">How to profile your applications using the Linux perf tools</a></li>
<li><a href="../../2010/07/profile-applications-java-visualvm.html">Profile your applications with Java VisualVM</a></li>
<li><a href="../10/diploma-thesis-inlining-assistance-for-large-scale-object-oriented-applications.html">Diploma Thesis : Inlining Assistance for large-scale object-oriented applications</a></li>
<li><a href="../../2010/02/modular-application-jtheque-core-2-0-3.html">Develop a modular application with JTheque Core 2.0.3</a></li>
<li><a href="../../2010/07/tip-profile-osgi-application-visualvm.html">Tip : Profile an OSGi application with VisualVM</a></li>
<li><a href="../../2012/04/install-valgrind-on-gentoo-linux.html">Install Valgrind on Gentoo Linux </a></li>
<li class="navbar-block">
<li class="wicht-navbar-right">
<a target="_blank" title="Follow @wichtounet on Twitter" href="https://twitter.com/wichtounet">
<img src="../../../assets/img/twitter.png" alt="Follow @wichtounet on Twitter"></a>
</li>
<li class="wicht-navbar-right">
<a target="_blank" title="Follow +BaptisteWicht on Google+" href="https://plus.google.com/+BaptisteWicht">
<img src="../../../assets/img/google_plus.png" alt="Follow +BaptisteWicht on Google+"></a>
</li>
</ul>
</div>

</nav>
</div> 
<div class="col-sm-9 col-lg-10">
<div id="content"></div>
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">How to profile C++ application with Callgrind / KCacheGrind</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">
Baptiste Wicht
</span></p>
<p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2011-09-01T08:25:10+02:00" itemprop="datePublished" title="2011-09-01 08:25">2011-09-01 08:25</time></a></p>
<p class="commentline">
<a href="profile-c-application-with-callgrind-kcachegrind.html#disqus_thread" data-disqus-identifier="cache/posts/2011/09/profile-c-application-with-callgrind-kcachegrind.html">Comments</a>
</p>
<p class="sourceline"><a href="profile-c-application-with-callgrind-kcachegrind.wp" class="sourcelink">Source</a></p>
</div>
</header><div class="e-content entry-content" itemprop="articleBody text">
<div>
<p>I have shown before how to <a title="Profile a C++ application with the Linux perf tools" href="http://www.baptiste-wicht.com/2011/07/profile-applications-linux-perf-tools/">profile a C++ application using the Linux perf tools</a>.  In this post, we will see how to profile the same kind of application using Callgrind. Callgrind is a tool in part of the Valgrind toolchain. It is running in Valgrind framework. The principle is not the same. When you use Callgrind to profile an application, your application is transformed in an intermediate language and then ran in a virtual processor emulated by valgrind. This has a huge run-time overhead, but the precision is really good and your profiling data is complete. An application running in Callgrind can be 10 to 50 times slower than normally.</p>
<p>The output of Callgrind is flat cal graph that is not really usable directly. In this post, we will use KCachegrind to display the informations about the profiling of the analyzed application.</p>

<h4>Installation</h4>
<p>First of all, you need to install Callgrind and KCachegrind. You also need to install graphviz in order to view the call graph in KCachegrind. The applications are already packaged for the most important Linux distributions. You can just use apt-get to install them:</p>
<pre>sudo apt-get install valgrind kcachegrind graphviz</pre>
<p>or aptitude:</p>
<pre>sudo aptitude install valgrind kcachegrind graphviz</pre>
<p>or whatever your favourite package manager is.</p>
<h4>Usage</h4>
<p>We have to start by profiling the application with Callgrind. To profile an application with Callgrind, you just have to prepend the Callgrind invocation in front of your normal program invocation:</p>
<pre>valgrind --tool=callgrind program [program_options]</pre>
<p>The result will be stored in a callgrind.out.XXX file where XXX will be the process identifier. </p>
<p>You can read this file using a text editor, but it won't be very useful because it's very cryptic. That's here that KCacheGrind will be useful. You can launch KCacheGrind using command line or in the program menu if your system installed it here. Then, you have to open your profile file. </p>
<p>The first view present a list of all the profiled functions. You can see the inclusive and the self cost of each function and the location of each one. </p>
<p><a href="../../../wp-content/uploads/2011/09/first-view2.png"><img alt="List of functions" src="../../../wp-content/uploads/2011/09/first-view2-300x212.png" title="Lost of functions"></a></p>
<p>Once you click on a function, the other views are filled with information. The view in uppper right part of the window gives some information about the selected function. </p>
<p><a href="../../../wp-content/uploads/2011/09/second-view.png"><img alt="Information about the function" src="../../../wp-content/uploads/2011/09/second-view-300x166.png" title="Information about the function"></a></p>
<p>The view have several tabs presenting different information: </p>
<ul>
<li>Types : Present the types of events that have been recorded. In our case, it's not really interesting, it's just the number of instructions fetch</li>
<li>Callers : List of the direct callers</li>
<li>All Callers : List of all the callers, it seems the callers and the callers of the callers</li>
<li>Callee Map : A map of the callee, personally, I do not really understand this view, but it's a kind of call graph representing the cost of the functions</li>
<li>Source code : The source code of the function if the application has been compiled with the debug symbol</li>
</ul>
<p>And finally, you have another view with data about the selected function. </p>
<p><a href="../../../wp-content/uploads/2011/09/third-view.png"><img alt="Information about the function" src="../../../wp-content/uploads/2011/09/third-view-300x208.png" title="Information about the function"></a></p>
<p>Again, several tabs: </p>
<ul>
<li>Callees : The direct callees of the function</li>
<li>Call Graph : The call graph from the function to the end</li>
<li>All Callees : All the callees and the callees of the callees</li>
<li>Caller Map : The map of the caller, again not really understandable for me</li>
<li>Machine Code : The machine code of the function if the application has been profiled with --dump-instr=yes option</li>
</ul>
<p>You have also several display options and filter features to find exactly what you want and display it the way you want. </p>
<p>The information provided by KCacheGrind can be very useful to find which functions takes too much time or which functions are called too much. </p>
<p>I hope this article will be useful.</p>
</div>
</div>
<aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/c%2B%2B.html" rel="tag">C++</a></li>
<li><a class="tag p-category" href="../../../categories/linux.html" rel="tag">Linux</a></li>
<li><a class="tag p-category" href="../../../categories/performances.html" rel="tag">Performances</a></li>
<li><a class="tag p-category" href="../../../categories/tools.html" rel="tag">Tools</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous">
<a href="../08/compute-metrics-of-c-project-using-cccc.html" rel="prev" title="How to compute metrics of C++ project using CCCC">Previous post</a>
</li>
<li class="next">
<a href="book-review-effective-c.html" rel="next" title="Book Review : Effective C++">Next post</a>
</li>
</ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
<div id="disqus_thread"></div>
<script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://baptiste-wicht.com/posts/2011/09/profile-c-application-with-callgrind-kcachegrind.html",
        disqus_title="How to profile C++ application with Callgrind / KCacheGrind",
        disqus_identifier="cache/posts/2011/09/profile-c-application-with-callgrind-kcachegrind.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
<a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>
</section></article><script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div> 
</div>

</div>



<footer>
Contents © 2017 <a href="/cdn-cgi/l/email-protection#9af8fbeaeef3e9eeffedf3f9f2eedafdf7fbf3f6b4f9f5f7">Baptiste Wicht</a> - Powered by <a href="http://getnikola.com" rel="nofollow">Nikola</a> - License:
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding-left:5px;border-width:0" src="../../../assets/img/cc.png"></a>
<ul class="footer_inline_ul">
<li>
<a href="profile-c-application-with-callgrind-kcachegrind.wp" id="sourcelink">Source</a>
</li>
</ul></footer><script src="/cdn-cgi/scripts/78d64697/cloudflare-static/email-decode.min.js"></script><script src="../../../assets/js/all-nocdn.js"></script>
</body>
</html>
