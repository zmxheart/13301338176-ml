<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Manage focus with Swing in Java | Blog blog("Baptiste Wicht");</title>
<script src="/cdn-cgi/apps/head/98vpnawSZZMscPn4oDND-ZgswjM.js"></script><link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">
<link rel="canonical" href="http://baptiste-wicht.com/posts/2010/03/java-swing-focus.html">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Baptiste Wicht">
<link rel="prev" href="bookmarks-bar-disappears-google-chrome.html" title="Tip : The bookmarks bar disappears on Google Chrome !" type="text/html">
<link rel="next" href="sonar-2-0-released.html" title="The version 2.0 of Sonar has been released" type="text/html">
<meta property="og:site_name" content='Blog blog("Baptiste Wicht");'>
<meta property="og:title" content="Manage focus with Swing in Java">
<meta property="og:url" content="http://baptiste-wicht.com/posts/2010/03/java-swing-focus.html">
<meta property="og:description" content="1. Introduction

The focus is the &quot;selected&quot; state of a component. The component who has the focus is the active component. It's possible to ask focus fror a specific component but normally this is pe">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2010-03-10T11:25:00+01:00">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Swing">
<link href="../../../favicon.ico" rel="icon" type="image/x-icon">
<link rel="publisher" href="https://plus.google.com/+BaptisteWicht">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-2175227-7', 'auto');
  var metas = document.getElementsByTagName('meta'), tagsList = [];
  for (var i=0; i<metas.length; i++) {
    if (metas[i].getAttribute('property') == 'article:tag') {
      tagsList.push( metas[i].getAttribute('content'));
    }
  }
  ga('set', 'dimension1', tagsList.join('|'));
  ga('send', 'pageview');
</script>
</head>
<body>

<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
<div class="container-fluid">

<div class="row">
<div class="col-sm-3 col-lg-2">
<nav class="navbar navbar-inverse navbar-fixed-side"><div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="http://baptiste-wicht.com/">
<span id="blog-title">Blog blog("Baptiste Wicht");</span>
</a>
</div>

<div class="collapse navbar-collapse navbar-ex1-collapse">
<ul class="nav navbar-nav">
<li>
<a href="../../../stories/about.html">About</a>
</li>
<li>
<a href="../../../stories/publications.html">Publications</a>
</li>
<li>
<a href="../../../stories/projects.html">Projects</a>
</li>
<li>
<a href="../../../categories/index.html">Tags</a>
</li>
<li>
<a href="../../../archive.html">Archives</a>
</li>
<li>
<a href="http://feeds.feedburner.com/BaptisteWicht">RSS</a>
 </li>
<li class="navbar-content">
<h3>Related posts</h3>
</li>
<li><a href="../../2009/12/swing-user-interface-jtable.html">Creation of Swing User Interface : Tables (JTable)</a></li>
<li><a href="../02/java-keywords.html">The reserved keywords of the Java Language</a></li>
<li><a href="osgi-and-cyclic-dependencies.html">OSGi and cyclic dependencies</a></li>
<li><a href="../07/rendezvous-concurrency-jr.html">Rendezvous, concurrency method, in JR</a></li>
<li><a href="mock-objects-easymock.html">Mock objects with EasyMock</a></li>
<li><a href="../04/java-7-more-dynamics.html">Java 7 : More dynamics</a></li>
<li class="navbar-block">
<li class="wicht-navbar-right">
<a target="_blank" title="Follow @wichtounet on Twitter" href="https://twitter.com/wichtounet">
<img src="../../../assets/img/twitter.png" alt="Follow @wichtounet on Twitter"></a>
</li>
<li class="wicht-navbar-right">
<a target="_blank" title="Follow +BaptisteWicht on Google+" href="https://plus.google.com/+BaptisteWicht">
<img src="../../../assets/img/google_plus.png" alt="Follow +BaptisteWicht on Google+"></a>
</li>
</ul>
</div>

</nav>
</div> 
<div class="col-sm-9 col-lg-10">
<div id="content"></div>
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Manage focus with Swing in Java</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">
Baptiste Wicht
</span></p>
<p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2010-03-10T11:25:00+01:00" itemprop="datePublished" title="2010-03-10 11:25">2010-03-10 11:25</time></a></p>
<p class="commentline">
<a href="java-swing-focus.html#disqus_thread" data-disqus-identifier="cache/posts/2010/03/java-swing-focus.html">Comments</a>
</p>
<p class="sourceline"><a href="java-swing-focus.wp" class="sourcelink">Source</a></p>
</div>
</header><div class="e-content entry-content" itemprop="articleBody text">
<div>
<h4>1. Introduction</h4>
<p>The focus is the "selected" state of a component. The component who has the focus is the active component. It's possible to ask focus fror a specific component but normally this is perfectly managed by Swing.</p>
<p>With this tutorial, you will learn how to ask focus for a specific component and how to define an order of focus. We will also learn a bit about the validation of input fields, the focus listen and the utility of KeyboardFocusManager.</p>
<h4>2. Ask focus</h4>
<p>Normally, the focus is managed by a component on the mouse click or when we come to a component with keyboard. A component who is focused is often visually modified, with a special border or an other background color.</p>
<p>To manage the focus of the windows, it's a little bit different and depends of the operating system, but nothing can give you the guarantee to have focus. On Windows, you can obtain focus on a window using toFront but nothing is guraranteed.</p>
<p>For the components, you can use the requestFocusInWindow() method :</p>
<pre class="code literal-block"><span></span><span class="n">component</span><span class="o">.</span><span class="na">requestFocusInWindow</span><span class="o">();</span>
</pre>
<p>To obtain the focus, you have to ask focus after the add of the component but before the display of the window.</p>
<p>Before Java 1.4, you needed to use the requestFocus() method, but now it is not a good idea to use it, because it give also focus to the window of the component, and that's not always possible.</p>

<h4>3. Navigation keys</h4>
<p>By default, we navigate in an application with the Tab and Shift+Tab keys. But we can edit these keys.</p>
<p>For that, we have to get the keys with getFocusTraversalKeys(int id) and add the new key. By example, here is how to add the Enter key for the forward focus navigation :</p>
<pre class="code literal-block"><span></span><span class="n">Set</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">textField</span><span class="o">.</span><span class="na">getFocusTraversalKeys</span><span class="o">(</span><span class="n">KeyboardFocusManager</span><span class="o">.</span><span class="na">FORWARD_TRAVERSAL_KEYS</span><span class="o">);</span>
<span class="n">Set</span> <span class="n">newKeys</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">(</span><span class="n">keys</span><span class="o">);</span>
<span class="n">newKeys</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">KeyStroke</span><span class="o">.</span><span class="na">getKeyStroke</span><span class="o">(</span><span class="n">KeyEvent</span><span class="o">.</span><span class="na">VK_ENTER</span><span class="o">,</span> <span class="mi">0</span><span class="o">));</span>
<span class="n">textField</span><span class="o">.</span><span class="na">setFocusTraversalKeys</span><span class="o">(</span><span class="n">KeyboardFocusManager</span><span class="o">.</span><span class="na">FORWARD_TRAVERSAL_KEYS</span><span class="o">,</span> <span class="n">newKeys</span><span class="o">);</span>
</pre>
<p>If you want to add a key for the backward navigation, you need to use BACKWARD_TRAVERSAL_KEYS instead of FORWARD_TRAVERSAL_KEYS.</p>
<h4>4. Validate an input</h4>
<p>You often need to validate to validate the inputs of the user in a field. The best way to do that is to test the content directly after the focus lost. Of course, there is still Formatter to do that, but it's possible that you must use the validation on a custom component.</p>
<p>To do that, we'lll use InputVerifier. This InputVerifier enable to get the value of a field when this field lost focus. If the value is not valid, the InputVerifier can execute a particular action by example set the old value in the field insted of the new invalid value or give focus again to the field.</p>
<p>To use it, we've to create a class extending InputVerifier and use the setInputVerifier() method on the component to test :</p>
<pre class="code literal-block"><span></span><span class="n">CustomInputVerifier</span> <span class="n">verifier</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CustomInputVerifier</span><span class="o">();</span>
<span class="o">...</span>
<span class="n">monComposant</span><span class="o">.</span><span class="na">setInputVerifier</span><span class="o">(</span><span class="n">verifier</span><span class="o">)</span>
</pre>
<p>The inputVerifier class has only two methods :</p>
<ul>
<li>verifiy(JComponent input) : Indicate if the value of the component is correct. It's must be overriden.</li>
<li>shouldYieldFocus(JComponent input) : This method idnicate if the component can loose focus or not. If it's return true, the focus change normally to the next component else the focus remains in the</li>
</ul>
<p>current component while the input is invalid. By default, it's only return the value of verify().</p>
<p>For lisibility reasons, it's better to only implement the test of the input value in the verify method and add the other functionalities by example a beep it it's invalid in the shouldYieldFocus method.</p>
<p>We will see a simple example of InputVerifier. This verifier verify that the value is a number greater than zero but lower than x. If the value is not valid, we simple emit a beep.</p>
<pre class="code literal-block"><span></span><span class="kn">import</span> <span class="nn">java.awt.Toolkit</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.InputVerifier</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JComponent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JTextField</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NumberInputVerifier</span> <span class="kd">extends</span> <span class="n">InputVerifier</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">NumberInputVerifier</span><span class="o">(){</span>
        <span class="k">this</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">NumberInputVerifier</span><span class="o">(</span><span class="kt">int</span> <span class="n">maximum</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="k">this</span><span class="o">.</span><span class="na">max</span> <span class="o">=</span> <span class="n">maximum</span><span class="o">;</span>
    <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">shouldYieldFocus</span><span class="o">(</span><span class="n">JComponent</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">valid</span> <span class="o">=</span> <span class="n">verify</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">valid</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">Toolkit</span><span class="o">.</span><span class="na">getDefaultToolkit</span><span class="o">().</span><span class="na">beep</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">verify</span><span class="o">(</span><span class="n">JComponent</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">JTextField</span> <span class="n">field</span> <span class="o">=</span> <span class="o">(</span><span class="n">JTextField</span><span class="o">)</span><span class="n">input</span><span class="o">;</span>

        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="na">getText</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">intValue</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">intValue</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NumberFormatException</span> <span class="n">pe</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">if</span><span class="o">(</span><span class="n">intValue</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">intValue</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">gt</span><span class="o">;</span> <span class="n">max</span><span class="o">){</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>You can of course make a lot of things with this class. You can use it to change the format of a number adding " or , or modify everithing else in the input component.</p>
<p>You can also use the same InputVerifier for several components. You just have to test the concerned component with the parameter of the verify method. But don't make too complex InputVerifier.</p>

<h4>5. Listen the focus</h4>
<p>A first way to know which component has the focus is to use a focus listener. You just have to create a class implementing FocusListener and add this listerner to every components you want to manage. Then, you just have to make things in the methods of the listener : focusGained and focusLost. This way is quite simple, but if you have a lot of components, it will be really heavy to implement.</p>
<p>An other way is to use the KeyboardFocusManager class. You just have to add a PropertyChangeListener on this class and verify the property focusOwner. You can also listener some other things : the focus of the windows, the changes on the focus order, ... You can find here a complete liste of properties. This times, you'll directly see all the focus changes for all the components in your application. If you want to restrain the set of components, you have to use the first way with FocusListener.</p>
<pre class="code literal-block"><span></span><span class="n">Here</span> <span class="n">is</span> <span class="n">an</span> <span class="n">example</span> <span class="n">with</span> <span class="n">KeyboardFocusManager</span> <span class="o">:</span>

<span class="n">KeyboardFocusManager</span> <span class="n">focusManager</span> <span class="o">=</span> <span class="n">KeyboardFocusManager</span><span class="o">.</span><span class="na">getCurrentKeyboardFocusManager</span><span class="o">();</span>

<span class="n">focusManager</span><span class="o">.</span><span class="na">addPropertyChangeListener</span><span class="o">(</span>
    <span class="k">new</span> <span class="n">PropertyChangeListener</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">propertyChange</span><span class="o">(</span><span class="n">PropertyChangeEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getPropertyName</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">((</span><span class="s">"focusOwner"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">properties</span><span class="o">))</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getNewValue</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">Component</span> <span class="n">component</span> <span class="o">=</span> <span class="o">(</span><span class="n">Component</span><span class="o">)</span><span class="n">e</span><span class="o">.</span><span class="na">getNewValue</span><span class="o">();</span>
                <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>

                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">" take focus"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<h4>6. Manage the order of focus</h4>
<p>Swing has a correct focus order by default and normally it's enough. But you can change this order, by example to navigate in a complex form. By default, Swing determinate the focus order using the order of adding the components to the content pane.</p>
<p>Before Java 1.4, you had to use setNextFocusableComponent() on every component to specify the next component to have the focus. This method is now deprecated. We'll use the LayoutFocusTraversalPolicy class to define the focus order in a Swing application.</p>
<p>For that, we have to create a new class extending FocusTraversalPolicy and define this set of methods :</p>
<ul>
<li>
<strong>getComponentAfter</strong> : Indicate which component will have focus after the component in parameter.</li>
<li>
<strong>getComponentBefore</strong> : Indicate which component has the focus before the component in parameter.</li>
<li>
<strong>getDefaultComponent</strong> : Indicate which component is the default component of the container on which we've applied the policy. It's used when we swith to this focus cycle.</li>
<li>
<strong>getLastComponent</strong> : Indicate which component is the last of this continer. It's used when we swith to this focus cycle.</li>
<li>
<strong>getFirstComponent</strong> : Indicate which component is the first of this container. It's used when we swith to this focus cycle.</li>
<li>
<strong>getInitialComponent</strong> : Indicate which component must have the focus when the window is displayed.</li>
</ul>
<p>Here is a little example :</p>
<pre class="code literal-block"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestFocusTraversalPolicy</span> <span class="kd">extends</span> <span class="n">FocusTraversalPolicy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getComponentAfter</span><span class="o">(</span><span class="n">Container</span> <span class="n">focusCycleRoot</span><span class="o">,</span> <span class="n">Component</span> <span class="n">aComponent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component1</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component2</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component2</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component3</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component3</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component4</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component4</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component5</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component5</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component1</span><span class="o">;</span>
        <span class="o">}</span> 

        <span class="k">return</span> <span class="n">component1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getComponentBefore</span><span class="o">(</span><span class="n">Container</span> <span class="n">focusCycleRoot</span><span class="o">,</span> <span class="n">Component</span> <span class="n">aComponent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component1</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component5</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component2</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component1</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component3</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component2</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component4</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component3</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">aComponent</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">component5</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">component4</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">component1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getDefaultComponent</span><span class="o">(</span><span class="n">Container</span> <span class="n">focusCycleRoot</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">component1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getLastComponent</span><span class="o">(</span><span class="n">Container</span> <span class="n">focusCycleRoot</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">component5</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getFirstComponent</span><span class="o">(</span><span class="n">Container</span> <span class="n">focusCycleRoot</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">component1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>The disadvantage of this technique is that the policy must know all the components. That why we often use an inner class to give it access to the member of the current class. Here is a simple example :</p>
<pre class="code literal-block"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">View</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Component</span> <span class="n">component1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Component</span> <span class="n">component2</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Component</span> <span class="n">component3</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Component</span> <span class="n">component4</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Component</span> <span class="n">component5</span><span class="o">;</span>

    <span class="kd">class</span> <span class="nc">TestFocusTraversalPolicy</span> <span class="kd">extends</span> <span class="n">FocusTraversalPolicy</span> <span class="o">{</span>
        <span class="c1">//Traversal policy methods</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>You can also use an inner anonymous class, but with that kind of class, you cannot use it for several components.</p>
<p>To apply this policy, you have to use the setFocusTraversalPolicy() method of the Container class :</p>
<pre class="code literal-block"><span></span><span class="n">TestFocusTraversalPolicy</span> <span class="n">newPolicy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestFocusTraversalPolicy</span><span class="o">();</span>
<span class="n">myContainer</span><span class="o">.</span><span class="na">setFocusTraversalPolicy</span><span class="o">(</span><span class="n">newPo</span>
</pre>
<p>Of course you can define several strategies for several panels or the same policy for several panels.</p>
<p>If you want to restore the default focus policy, you just have to call setFocusTraversalPolicy() with null as parameter.</p>
<p>You can also edit the default FocusTraversalPolicy with one of yours with the setDefaultTraversalPolicy() method from the KeyboardFocusManager class.</p>
<h5>6.1. Simplification</h5>
<p>But it's not very easy to do that and that can quickly be heavy. So here is a simple class to manage the positions of all the components with an integer :</p>
<pre class="code literal-block"><span></span><span class="kn">import</span> <span class="nn">java.awt.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.Container</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.FocusTraversalPolicy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * A focus traversal policy who manage the order of components in the focus cycle using a int.</span>
<span class="cm"> * The first component of the cycle  has the position of 0 and all the others follows with an interval of 1.</span>
<span class="cm"> * The last component must have the position (size() -1).</span>
<span class="cm"> *</span>
<span class="cm"> * @author Baptiste Wicht</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MapFocusTraversalPolicy</span> <span class="kd">extends</span> <span class="n">FocusTraversalPolicy</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">HashMap</span> <span class="n">components</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
    <span class="kd">private</span> <span class="n">HashMap</span> <span class="n">positions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>

    <span class="cm">/**</span>
<span class="cm">     * Add the component to the order with the specfieid position.</span>
<span class="cm">     *</span>
<span class="cm">     * @param component The component to add.</span>
<span class="cm">     * @param position The position of the component in the focus cycle root.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addComponent</span><span class="o">(</span><span class="n">Component</span> <span class="n">component</span><span class="o">,</span> <span class="kt">int</span> <span class="n">position</span><span class="o">){</span>
        <span class="n">components</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">position</span><span class="o">,</span> <span class="n">component</span><span class="o">);</span>
        <span class="n">positions</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">component</span><span class="o">,</span> <span class="n">position</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getComponentAfter</span><span class="o">(</span><span class="n">Container</span> <span class="n">parent</span><span class="o">,</span> <span class="n">Component</span> <span class="n">component</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">position</span> <span class="o">=</span> <span class="n">positions</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">component</span><span class="o">);</span>

        <span class="k">if</span><span class="o">(</span><span class="n">position</span> <span class="o">=</span> <span class="n">positions</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">){</span>
            <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">position</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getComponentBefore</span><span class="o">(</span><span class="n">Container</span> <span class="n">parent</span><span class="o">,</span> <span class="n">Component</span> <span class="n">component</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">position</span> <span class="o">=</span> <span class="n">positions</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">component</span><span class="o">);</span>

        <span class="k">if</span><span class="o">(</span><span class="n">position</span> <span class="o">=</span> <span class="mi">0</span><span class="o">){</span>
            <span class="n">position</span> <span class="o">=</span> <span class="n">positions</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">position</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getDefaultComponent</span><span class="o">(</span><span class="n">Container</span> <span class="n">parent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getFirstComponent</span><span class="o">(</span><span class="n">Container</span> <span class="n">parent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getLastComponent</span><span class="o">(</span><span class="n">Container</span> <span class="n">parent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">components</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>Vous can use this class as every other focus traversal policy we saw before. Just add all the components before using the policy.</p>
<p>An other way that you can explore it's to make all your components implementing an interface like Focusable with a getFocusPosition() method and use a policy to make the order with that Focusable components.</p>
<h4>7. The KeyboardFocusManager class</h4>
<p>There is also other utilities to the KeyboardFocusManager class.</p>
<p>First, you can change the component who has the focus with the focusXXX methods. By example, you can use the focusNextComponent() method to give the focus to the next component. you can also give the focus to a specific component with the setFocusOwner method or to a window with with the setActiveWindows method.</p>
<p>Then, you can also get the active window, the component with the focux and the container who contains the active component. If the components are in an other thread, you have to use the getGlobalXXX methods to get it.</p>

<h4>8. Conclusion</h4>
<p>To conclude, you can do almost everithing with the focus system. You can modify the order of focus for the components, say which components must have the focus, make tests on the input fields, know who has the focus. But that's sometimes weird when we start. But once we've understand which classes to use, it is quite simple.</p>
</div>
</div>
<aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/java.html" rel="tag">Java</a></li>
<li><a class="tag p-category" href="../../../categories/swing.html" rel="tag">Swing</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous">
<a href="bookmarks-bar-disappears-google-chrome.html" rel="prev" title="Tip : The bookmarks bar disappears on Google Chrome !">Previous post</a>
</li>
<li class="next">
<a href="sonar-2-0-released.html" rel="next" title="The version 2.0 of Sonar has been released">Next post</a>
</li>
</ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
<div id="disqus_thread"></div>
<script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://baptiste-wicht.com/posts/2010/03/java-swing-focus.html",
        disqus_title="Manage focus with Swing in Java",
        disqus_identifier="cache/posts/2010/03/java-swing-focus.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
<a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>
</section></article><script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div> 
</div>

</div>



<footer>
Contents Â© 2017 <a href="/cdn-cgi/l/email-protection#107271606479636475677973786450777d71797c3e737f7d">Baptiste Wicht</a> - Powered by <a href="http://getnikola.com" rel="nofollow">Nikola</a> - License:
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding-left:5px;border-width:0" src="../../../assets/img/cc.png"></a>
<ul class="footer_inline_ul">
<li>
<a href="java-swing-focus.wp" id="sourcelink">Source</a>
</li>
</ul></footer><script src="/cdn-cgi/scripts/78d64697/cloudflare-static/email-decode.min.js"></script><script src="../../../assets/js/all-nocdn.js"></script>
</body>
</html>
