<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Manage command-line options with Boost Program Options | Blog blog("Baptiste Wicht");</title>
<script src="/cdn-cgi/apps/head/98vpnawSZZMscPn4oDND-ZgswjM.js"></script><link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">
<link rel="canonical" href="http://baptiste-wicht.com/posts/2012/07/manage-command-line-boost-program-options.html">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Baptiste Wicht">
<link rel="prev" href="c11-concurrency-tutorial-part-4-atomic-type.html" title="C++11 Concurrency Tutorial - Part 4: Atomic Types" type="text/html">
<link rel="next" href="eddi-compiler-1-1-0-member-functions.html" title="EDDI Compiler 1.1.0 - Member functions" type="text/html">
<meta property="og:site_name" content='Blog blog("Baptiste Wicht");'>
<meta property="og:title" content="Manage command-line options with Boost Program Options">
<meta property="og:url" content="http://baptiste-wicht.com/posts/2012/07/manage-command-line-boost-program-options.html">
<meta property="og:description" content="In command-line program, we often faces problems with the management of command-line options. When you have a few options, it's not a problem. But when writing complex programs with tens of options (o">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2012-07-19T08:19:37+02:00">
<meta property="article:tag" content="Boost">
<meta property="article:tag" content="C++">
<link href="../../../favicon.ico" rel="icon" type="image/x-icon">
<link rel="publisher" href="https://plus.google.com/+BaptisteWicht">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-2175227-7', 'auto');
  var metas = document.getElementsByTagName('meta'), tagsList = [];
  for (var i=0; i<metas.length; i++) {
    if (metas[i].getAttribute('property') == 'article:tag') {
      tagsList.push( metas[i].getAttribute('content'));
    }
  }
  ga('set', 'dimension1', tagsList.join('|'));
  ga('send', 'pageview');
</script>
</head>
<body>

<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
<div class="container-fluid">

<div class="row">
<div class="col-sm-3 col-lg-2">
<nav class="navbar navbar-inverse navbar-fixed-side"><div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="http://baptiste-wicht.com/">
<span id="blog-title">Blog blog("Baptiste Wicht");</span>
</a>
</div>

<div class="collapse navbar-collapse navbar-ex1-collapse">
<ul class="nav navbar-nav">
<li>
<a href="../../../stories/about.html">About</a>
</li>
<li>
<a href="../../../stories/publications.html">Publications</a>
</li>
<li>
<a href="../../../stories/projects.html">Projects</a>
</li>
<li>
<a href="../../../categories/index.html">Tags</a>
</li>
<li>
<a href="../../../archive.html">Archives</a>
</li>
<li>
<a href="http://feeds.feedburner.com/BaptisteWicht">RSS</a>
</li>
<li class="navbar-content">
<h3>Related posts</h3>
</li>
<li><a href="../../2010/10/compute-command-line-arguments-with-apache-commons-cli.html">Compute command-line arguments with Apache Commons CLI</a></li>
<li><a href="../../2011/11/boost-1-48-0-has-been-released.html">Boost 1.48.0 has been released </a></li>
<li><a href="../../2011/11/eddic-0-5-1-better-assembly-generation-and-faster-parsing.html">eddic 0.5.1 : Better assembly generation and faster parsing</a></li>
<li><a href="../01/boost-enable_if-handle-ambiguous-function-overload-void.html">Use Boost enable_if to handle ambiguous function overload return types</a></li>
<li><a href="../../2017/05/cpp-containers-benchmark-vector-list-deque-plf-colony.html">C++ Containers Benchmark: vector/list/deque and plf::colony</a></li>
<li><a href="../../2016/06/eddic-124-new-boost-spirit-x3-parser-and-minor-cleanups.html">eddic 1.2.4: New Boost Spirit X3 parser and minor cleanups</a></li>
<li class="navbar-block">
<li class="wicht-navbar-right">
<a target="_blank" title="Follow @wichtounet on Twitter" href="https://twitter.com/wichtounet">
<img src="../../../assets/img/twitter.png" alt="Follow @wichtounet on Twitter"></a>
</li>
<li class="wicht-navbar-right">
<a target="_blank" title="Follow +BaptisteWicht on Google+" href="https://plus.google.com/+BaptisteWicht">
<img src="../../../assets/img/google_plus.png" alt="Follow +BaptisteWicht on Google+"></a>
</li>
</ul>
</div>

</nav>
</div> 
<div class="col-sm-9 col-lg-10">
<div id="content"></div>
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Manage command-line options with Boost Program Options</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">
Baptiste Wicht
</span></p>
<p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2012-07-19T08:19:37+02:00" itemprop="datePublished" title="2012-07-19 08:19">2012-07-19 08:19</time></a></p>
<p class="commentline">
<a href="manage-command-line-boost-program-options.html#disqus_thread" data-disqus-identifier="cache/posts/2012/07/manage-command-line-boost-program-options.html">Comments</a>
</p>
<p class="sourceline"><a href="manage-command-line-boost-program-options.wp" class="sourcelink">Source</a></p>
</div>
</header><div class="e-content entry-content" itemprop="articleBody text">
<div>
<p>In command-line program, we often faces problems with the management of command-line options. When you have a few options, it's not a problem. But when writing complex programs with tens of options (or hundreds), it starts to be too complicated to manage by hand. That's where <strong>Boost Program Options</strong> enters the game!</p>
<p>Boost Program Options is one of the Boost C++ Libraries. It is a very powerful library to handle command-line options. You define all the options of the program and then Boost Program Options takes care of all. It parses the command line, handles errors, gets values and even displays help. It is not a perfect library. But it is very complete that will answer most of the common needs. </p>
<p>This library is not header-only. You will need to build the library and link your program with the library. </p>
<h4>Getting started</h4>
<p>In this article, I will use <em>po</em> as an abbreviation of boost::program_options and all source will contains this namespace alias:</p>
<pre class="code literal-block"><span></span><span class="k">namespace</span> <span class="n">po</span> <span class="o">=</span> <span class="n">boost</span><span class="o">::</span><span class="n">program_options</span><span class="p">;</span>
</pre>
<p>First of all, it is necessary to create an instance of po::option_description:</p>
<pre class="code literal-block"><span></span><span class="n">po</span><span class="o">::</span><span class="n">options_description</span> <span class="n">description</span><span class="p">(</span><span class="s">"MyTool Usage"</span><span class="p">);</span>

<span class="n">description</span><span class="p">.</span><span class="n">add_options</span><span class="p">()</span>
    <span class="p">(</span><span class="s">"help"</span><span class="p">,</span> <span class="s">"Display this help message"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"version"</span><span class="p">,</span> <span class="s">"Display the version number"</span><span class="p">);</span>
</pre>
<p>The parameter to the constructor is the title of the options. To add options, you use the add_options() function and append all your options, each one surrounded with parenthesis. Here, we declared two options (help and version). They can be set with <em>--help</em> and <em>--version</em>. </p>
<p>Then, you can parse the command line by declaring a po::variables_map to store the variables and parse the command line into that storage: </p>
<pre class="code literal-block"><span></span><span class="n">po</span><span class="o">::</span><span class="n">variables_map</span> <span class="n">vm</span><span class="p">;</span>
<span class="n">po</span><span class="o">::</span><span class="n">store</span><span class="p">(</span><span class="n">po</span><span class="o">::</span><span class="n">command_line_parser</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">).</span><span class="n">options</span><span class="p">(</span><span class="n">description</span><span class="p">).</span><span class="n">run</span><span class="p">(),</span> <span class="n">vm</span><span class="p">);</span>
<span class="n">po</span><span class="o">::</span><span class="n">notify</span><span class="p">(</span><span class="n">vm</span><span class="p">);</span>
</pre>
<p>Then, you can easily verify if an option has been set by using the <em>count(const std::string&amp; name)</em> function on the <em>vm</em> object: </p>
<pre class="code literal-block"><span></span><span class="k">if</span><span class="p">(</span><span class="n">vm</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">"help"</span><span class="p">)){</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">description</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p>You can use <em>operator on the description to output all the options of program. </em></p>
<h4>Short options</h4>
<p>By default, all the options are accessed by using -- in front of them. You can also specify a short version for each option: </p>
<pre class="code literal-block"><span></span><span class="n">description</span><span class="p">.</span><span class="n">add_options</span><span class="p">()</span>
    <span class="p">(</span><span class="s">"help,h"</span><span class="p">,</span> <span class="s">"Display this help message"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"version,v"</span><span class="p">,</span> <span class="s">"Display the version number"</span><span class="p">);</span>
</pre>
<p>With that, you can display with either --help or -h. Even if you select help with -h, you can still verify if help has been set with count("help"). </p>
<h4>Option with value</h4>
<p>Boost Program Options can also handle option that need a specific value. Lets add a <i>compression</i> option:</p>
<pre class="code literal-block"><span></span><span class="n">description</span><span class="p">.</span><span class="n">add_options</span><span class="p">()</span>
    <span class="p">(</span><span class="s">"help,h"</span><span class="p">,</span> <span class="s">"Display this help message"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"compression,c"</span><span class="p">,</span> <span class="n">po</span><span class="o">::</span><span class="n">value</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(),</span> <span class="s">"Compression level"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"version,v"</span><span class="p">,</span> <span class="s">"Display the version number"</span><span class="p">);</span>
</pre>
<p>You can then get the value of option easily: </p>
<pre class="code literal-block"><span></span><span class="k">if</span><span class="p">(</span><span class="n">vm</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">"compression"</span><span class="p">)){</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Compression level "</span> <span class="o">&lt;&lt;</span> <span class="n">vm</span><span class="p">[</span><span class="s">"compression"</span><span class="p">].</span><span class="n">as</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p>For the story, the option value are stored as boost::any. You can get the value of the option by using operator[] on the po::variables_map. You can get the value type with the as function with the type you need. </p>
<p>On the command line, the value can be set with --compression 10, -c 10 or -c10. </p>
<p>You can also configure a default value for an option:</p>
<pre class="code literal-block"><span></span><span class="n">description</span><span class="p">.</span><span class="n">add_options</span><span class="p">()</span>
    <span class="p">(</span><span class="s">"help,h"</span><span class="p">,</span> <span class="s">"Display this help message"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"compression,c"</span><span class="p">,</span> <span class="n">po</span><span class="o">::</span><span class="n">value</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">default_value</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s">"Compression level"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"version,v"</span><span class="p">,</span> <span class="s">"Display the version number"</span><span class="p">);</span>
</pre>
<p>With that, if the option is not set on the command line, the option has the specified value. With that, the option is always defined. </p>
<p>Finally, you can also set an implicit value. This is the value of the option is the option is set to the command line without a value (--compression or -c): </p>
<pre class="code literal-block"><span></span><span class="n">description</span><span class="p">.</span><span class="n">add_options</span><span class="p">()</span>
    <span class="p">(</span><span class="s">"help,h"</span><span class="p">,</span> <span class="s">"Display this help message"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"compression,c"</span><span class="p">,</span> <span class="n">po</span><span class="o">::</span><span class="n">value</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">default_value</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">implicit_value</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s">"Compression level"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"version,v"</span><span class="p">,</span> <span class="s">"Display the version number"</span><span class="p">);</span>
</pre>
<h4>Positional options</h4>
<p>It is often convenient to have a list of files on the command line. These options does not have a name. In Boost Program Options, these options are called positional options. You have to declare them in the describe as any other action. For example, for a list of files: </p>
<pre class="code literal-block"><span></span><span class="n">description</span><span class="p">.</span><span class="n">add_options</span><span class="p">()</span>
    <span class="p">(</span><span class="s">"help,h"</span><span class="p">,</span> <span class="s">"Display this help message"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"compression,c"</span><span class="p">,</span> <span class="n">po</span><span class="o">::</span><span class="n">value</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">default_value</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">implicit_value</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s">"Compression level"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"input-files"</span><span class="p">,</span> <span class="n">po</span><span class="o">::</span><span class="n">value</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&gt;</span><span class="p">(),</span> <span class="s">"Input files"</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"version,v"</span><span class="p">,</span> <span class="s">"Display the version number"</span><span class="p">);</span>
</pre>
<p>Then, you have to declare it as positional and then finally specify it when parsing the command-line: </p>
<pre class="code literal-block"><span></span><span class="n">po</span><span class="o">::</span><span class="n">positional_options_description</span> <span class="n">p</span><span class="p">;</span>
<span class="n">p</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">"input-files"</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">po</span><span class="o">::</span><span class="n">variables_map</span> <span class="n">vm</span><span class="p">;</span>
<span class="n">po</span><span class="o">::</span><span class="n">store</span><span class="p">(</span><span class="n">po</span><span class="o">::</span><span class="n">command_line_parser</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">).</span><span class="n">options</span><span class="p">(</span><span class="n">description</span><span class="p">).</span><span class="n">positional</span><span class="p">(</span><span class="n">p</span><span class="p">).</span><span class="n">run</span><span class="p">(),</span> <span class="n">vm</span><span class="p">);</span>
<span class="n">po</span><span class="o">::</span><span class="n">notify</span><span class="p">(</span><span class="n">vm</span><span class="p">);</span>
</pre>
<p>The positional options values are retrieved the exact same way as other options: </p>
<pre class="code literal-block"><span></span><span class="k">if</span><span class="p">(</span><span class="n">vm</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">"input-files"</span><span class="p">)){</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">files</span> <span class="o">=</span> <span class="n">vm</span><span class="p">[</span><span class="s">"input-files"</span><span class="p">].</span><span class="n">as</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&gt;</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="nl">file</span> <span class="p">:</span> <span class="n">files</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Input file "</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
<h4>Wrap-Up</h4>
<p>In this article, we saw the most important aspects of Boost Program Options. With these notions, you can start using this great library. If you need more information about the library, you can read <a href="http://www.boost.org/doc/libs/1_50_0/doc/html/program_options.html" title="Boost Program Options documentation">the official documentation</a> that is very well made. </p>
<p>You can download the final sources of this article on Github: <a href="https://github.com/wichtounet/articles/blob/master/src/boost_po/v1.cpp" title="Source file for this article">v1.cpp</a></p>
</div>
</div>
<aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/boost.html" rel="tag">Boost</a></li>
<li><a class="tag p-category" href="../../../categories/c%2B%2B.html" rel="tag">C++</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous">
<a href="c11-concurrency-tutorial-part-4-atomic-type.html" rel="prev" title="C++11 Concurrency Tutorial - Part 4: Atomic Types">Previous post</a>
</li>
<li class="next">
<a href="eddi-compiler-1-1-0-member-functions.html" rel="next" title="EDDI Compiler 1.1.0 - Member functions">Next post</a>
</li>
</ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
<div id="disqus_thread"></div>
<script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://baptiste-wicht.com/posts/2012/07/manage-command-line-boost-program-options.html",
        disqus_title="Manage command-line options with Boost Program Options",
        disqus_identifier="cache/posts/2012/07/manage-command-line-boost-program-options.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
<a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>
</section></article><script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div> 
</div>

</div>



<footer>
Contents Â© 2017 <a href="/cdn-cgi/l/email-protection#a6c4c7d6d2cfd5d2c3d1cfc5ced2e6c1cbc7cfca88c5c9cb">Baptiste Wicht</a> - Powered by <a href="http://getnikola.com" rel="nofollow">Nikola</a> - License:
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding-left:5px;border-width:0" src="../../../assets/img/cc.png"></a>
<ul class="footer_inline_ul">
<li>
<a href="manage-command-line-boost-program-options.wp" id="sourcelink">Source</a>
</li>
</ul></footer><script src="/cdn-cgi/scripts/78d64697/cloudflare-static/email-decode.min.js"></script><script src="../../../assets/js/all-nocdn.js"></script>
</body>
</html>
